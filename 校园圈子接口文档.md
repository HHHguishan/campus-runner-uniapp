# 校园圈子功能模块接口文档

本文档详细记录了校园圈子（论坛）功能的后端接口参数和响应结构。

## 1. 帖子管理接口
**Base URL**: `/api/forum/post`

### 1.1 发布帖子
发布新的校园圈子帖子，支持多图上传。

- **URL**: `/`
- **Method**: `POST`
- **Header**: `Authorization: Bearer <token>`
- **Content-Type**: `application/json`

**请求参数 (Body)**

| 参数名 | 类型 | 必选 | 说明 | 限制 |
| :--- | :--- | :--- | :--- | :--- |
| title | string | 是 | 帖子标题 | 1-100字 |
| content | string | 是 | 帖子正文 | 1-5000字 |
| images | array | 否 | 图片URL列表 | 最多9张 |
| tag | string | 否 | 标签 | 例如：失物, 吐槽, 闲置, 求助, 表白 |

**请求示例**
```json
{
  "title": "图书馆二楼捡到一个蓝牙耳机",
  "content": "如题，在图书馆二楼C区座位上捡到的，黑色的，放在前台了。",
  "images": [
    "https://example.com/img1.jpg",
    "https://example.com/img2.jpg"
  ],
  "tag": "失物"
}
```

**响应结果**
```json
{
  "code": 200,
  "msg": "发布成功",
  "data": 10001 // 新建帖子的ID
}
```

---

### 1.2 获取帖子列表
分页查询帖子列表，支持筛选和搜索。

- **URL**: `/list`
- **Method**: `GET`
- **Header**: `Authorization: Bearer <token>` (可选，登录后可看点赞状态)

**查询参数 (Query)**

| 参数名 | 类型 | 必选 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| page | integer | 否 | 1 | 页码 |
| size | integer | 否 | 10 | 每页条数 |
| tag | string | 否 | null | 按标签筛选 |
| keyword | string | 否 | null | 搜索关键词（标题或内容） |
| orderBy | string | 否 | time | 排序方式: `time`(最新), `hot`(最热) |

**响应结果 (PostListVO)**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 10001,
        "userId": 2001,
        "nickname": "张三",
        "avatar": "https://avatar.url",
        "title": "图书馆二楼捡到一个蓝牙耳机",
        "contentPreview": "如题，在图书馆二楼C区座位上捡到的...",
        "images": ["https://img.url"],
        "tag": "失物",
        "likeCount": 10,
        "commentCount": 5,
        "viewCount": 100,
        "liked": false,
        "createTime": "2023-10-27T10:00:00"
      }
    ],
    "total": 1,
    "size": 10,
    "current": 1
  }
}
```

---

### 1.3 获取帖子详情
查看帖子详细内容，包括完整正文。每次调用自动增加浏览量。

- **URL**: `/{id}`
- **Method**: `GET`
- **Header**: `Authorization: Bearer <token>` (可选，登录后可看点赞状态)

**路径参数 (Path)**

| 参数名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | long | 帖子ID |

**响应结果 (PostDetailVO)**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 10001,
    "userId": 2001,
    "nickname": "张三",
    "avatar": "https://avatar.url",
    "title": "图书馆二楼捡到一个蓝牙耳机",
    "content": "完整的内容...",
    "images": ["https://img.url"],
    "tag": "失物",
    "likeCount": 12,
    "commentCount": 6,
    "viewCount": 101,
    "liked": true,
    "isOwner": false, // 是否是当前用户发布的帖子
    "createTime": "2023-10-27T10:00:00",
    "updateTime": "2023-10-27T10:00:00"
  }
}
```

---

### 1.4 删除帖子
用户删除自己发布的帖子。

- **URL**: `/{id}`
- **Method**: `DELETE`
- **Header**: `Authorization: Bearer <token>`

**路径参数**

| 参数名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | long | 帖子ID |

**响应结果**
```json
{
  "code": 200,
  "msg": "删除成功",
  "data": null
}
```

---

### 1.5 点赞/取消点赞
对帖子进行点赞或取消点赞，接口自动切换状态。

- **URL**: `/{id}/like`
- **Method**: `POST`
- **Header**: `Authorization: Bearer <token>`

**路径参数**

| 参数名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | long | 帖子ID |

**响应结果 (LikeResultVO)**
```json
{
  "code": 200,
  "msg": "点赞成功", // 或 "取消点赞成功"
  "data": {
    "liked": true, // 当前是否点赞
    "likeCount": 13, // 最新点赞数
    "message": "点赞成功"
  }
}
```

---

### 1.6 我的帖子
查询当前登录用户发布的帖子列表。

- **URL**: `/my`
- **Method**: `GET`
- **Header**: `Authorization: Bearer <token>`

**查询参数**

| 参数名 | 类型 | 必选 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| page | integer | 否 | 1 | 页码 |
| size | integer | 否 | 10 | 每页条数 |

**响应结果**
同"获取帖子列表" (PostListVO)

---

## 2. 评论管理接口
**Base URL**: `/api/forum/comment`

### 2.1 发表评论
对帖子进行评论，或回复某条评论。

- **URL**: `/`
- **Method**: `POST`
- **Header**: `Authorization: Bearer <token>`
- **Content-Type**: `application/json`

**请求参数 (Body)**

| 参数名 | 类型 | 必选 | 说明 | 限制 |
| :--- | :--- | :--- | :--- | :--- |
| postId | long | 是 | 帖子ID | |
| parentId | long | 否 | 父评论ID | 回复楼中楼时填写 |
| content | string | 是 | 评论内容 | 1-500字 |

**请求示例**
```json
{
  "postId": 10001,
  "content": "好人一生平安！"
}
```

**响应结果**
```json
{
  "code": 200,
  "msg": "评论成功",
  "data": 5001 // 新建评论ID
}
```

---

### 2.2 获取评论列表
分页查询某篇帖子的评论。

- **URL**: `/list`
- **Method**: `GET`
- **Header**: `Authorization: Bearer <token>` (可选)

**查询参数 (Query)**

| 参数名 | 类型 | 必选 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| postId | long | 是 | - | 帖子ID |
| page | integer | 否 | 1 | 页码 |
| size | integer | 否 | 20 | 每页条数 |
| orderBy | string | 否 | time | 排序方式: `time`(时间), `hot`(热度) |

**响应结果 (CommentVO)**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 5001,
        "postId": 10001,
        "parentId": null,
        "userId": 2002,
        "nickname": "李四",
        "avatar": "https://avatar.url",
        "content": "好人一生平安！",
        "likeCount": 2,
        "isOwner": false,
        "replies": [], // 子评论列表（如有）
        "createTime": "2023-10-27T10:05:00"
      }
    ],
    "total": 1,
    "size": 20,
    "current": 1
  }
}
```

---

### 2.3 删除评论
用户删除自己发布的评论。

- **URL**: `/{id}`
- **Method**: `DELETE`
- **Header**: `Authorization: Bearer <token>`

**路径参数**

| 参数名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | long | 评论ID |

**响应结果**
```json
{
  "code": 200,
  "msg": "删除成功",
  "data": null
}
```
