{"version":3,"file":"common.js","sources":["api/common.js"],"sourcesContent":["/**\r\n * 通用API\r\n */\r\n\r\nimport { post } from '../utils/request.js'\r\n\r\n/**\r\n * 文件上传\r\n * @param {String} filePath - 本地文件路径\r\n * @param {String} type - 文件类型（avatar/id_card/temp）\r\n * @returns {Promise}\r\n */\r\nexport function uploadFile(filePath, type = 'temp') {\r\n  return new Promise((resolve, reject) => {\r\n    uni.uploadFile({\r\n      url: 'http://localhost:9090/api/common/upload',\r\n      filePath: filePath,\r\n      name: 'file',\r\n      formData: {\r\n        type: type\r\n      },\r\n      header: {\r\n        'Authorization': 'Bearer ' + uni.getStorageSync('Authorization')\r\n      },\r\n      success: (uploadRes) => {\r\n        if (uploadRes.statusCode === 200) {\r\n          const data = JSON.parse(uploadRes.data)\r\n          if (data.code === 200) {\r\n            resolve(data)\r\n          } else {\r\n            reject(new Error(data.message))\r\n          }\r\n        } else {\r\n          reject(new Error('上传失败'))\r\n        }\r\n      },\r\n      fail: (error) => {\r\n        reject(error)\r\n      }\r\n    })\r\n  })\r\n}\r\n"],"names":["uni"],"mappings":";;AAYO,SAAS,WAAW,UAAU,OAAO,QAAQ;AAClD,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,kBAAAA,MAAI,WAAW;AAAA,MACb,KAAK;AAAA,MACL;AAAA,MACA,MAAM;AAAA,MACN,UAAU;AAAA,QACR;AAAA,MACD;AAAA,MACD,QAAQ;AAAA,QACN,iBAAiB,YAAYA,oBAAI,eAAe,eAAe;AAAA,MAChE;AAAA,MACD,SAAS,CAAC,cAAc;AACtB,YAAI,UAAU,eAAe,KAAK;AAChC,gBAAM,OAAO,KAAK,MAAM,UAAU,IAAI;AACtC,cAAI,KAAK,SAAS,KAAK;AACrB,oBAAQ,IAAI;AAAA,UACxB,OAAiB;AACL,mBAAO,IAAI,MAAM,KAAK,OAAO,CAAC;AAAA,UAC/B;AAAA,QACX,OAAe;AACL,iBAAO,IAAI,MAAM,MAAM,CAAC;AAAA,QACzB;AAAA,MACF;AAAA,MACD,MAAM,CAAC,UAAU;AACf,eAAO,KAAK;AAAA,MACb;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;;"}