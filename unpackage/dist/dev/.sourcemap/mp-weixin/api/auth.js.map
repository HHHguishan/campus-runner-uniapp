{"version":3,"file":"auth.js","sources":["api/auth.js"],"sourcesContent":["/**\r\n * 认证相关API\r\n */\r\n\r\nimport { get, post } from '../utils/request.js'\r\nimport { setToken, setUserInfo } from '../utils/token.js'\r\n\r\n/**\r\n * 发送短信验证码\r\n * @param {String} phone - 手机号\r\n * @returns {Promise}\r\n */\r\nexport function sendSmsCode(phone) {\r\n\treturn post('/sms/send-code?phone=' + phone)\r\n}\r\n\r\n/**\r\n * 检查发送验证码限制\r\n * @param {String} phone - 手机号\r\n * @returns {Promise}\r\n */\r\nexport function checkSmsLimit(phone) {\r\n\treturn get('/sms/check-limit', { phone })\r\n}\r\n\r\n/**\r\n * 手机号验证码登录\r\n * @param {Object} data - 登录数据\r\n * @param {String} data.phone - 手机号\r\n * @param {String} data.code - 验证码\r\n * @param {String} data.deviceInfo - 设备信息（可选）\r\n * @param {String} data.location - 地理位置（可选）\r\n * @returns {Promise}\r\n */\r\nexport function loginByPhone(data) {\r\n\treturn post('/auth/login/phone', data)\r\n}\r\n\r\n/**\r\n * 微信小程序登录\r\n * @param {Object} data - 登录数据\r\n * @param {String} data.code - 微信登录code\r\n * @param {String} data.avatar - 头像URL\r\n * @param {String} data.nickname - 昵称\r\n * @returns {Promise}\r\n */\r\nexport function loginByWechat(data) {\r\n\treturn post('/auth/login/wechat', data)\r\n}\r\n\r\n/**\r\n * 退出登录\r\n * @returns {Promise}\r\n */\r\nexport function logout() {\r\n\t// 清除本地存储的Token和用户信息\r\n\tuni.removeStorageSync('Authorization')\r\n\tuni.removeStorageSync('userInfo')\r\n\r\n\treturn Promise.resolve()\r\n}\r\n\r\n/**\r\n * 登录成功后的处理\r\n * @param {Object} loginData - 登录返回数据\r\n * @param {String} loginData.token - JWT Token\r\n * @param {Object} loginData.data - 用户信息\r\n */\r\nexport function handleLoginSuccess(loginData) {\r\n\tconst { token, ...userInfo } = loginData\r\n\r\n\t// 1. 存储Token\r\n\tsetToken(token)\r\n\r\n\t// 2. 存储用户信息\r\n\tsetUserInfo(userInfo)\r\n\r\n\tconsole.log('✅ 登录成功，用户信息已保存:', userInfo)\r\n}\r\n"],"names":["post","setToken","setUserInfo","uni"],"mappings":";;;;AAYO,SAAS,YAAY,OAAO;AAClC,SAAOA,cAAI,KAAC,0BAA0B,KAAK;AAC5C;AAoBO,SAAS,aAAa,MAAM;AAClC,SAAOA,cAAI,KAAC,qBAAqB,IAAI;AACtC;AAgCO,SAAS,mBAAmB,WAAW;AAC7C,QAAM,EAAE,OAAO,GAAG,SAAQ,IAAK;AAG/BC,cAAAA,SAAS,KAAK;AAGdC,cAAAA,YAAY,QAAQ;AAEpBC,gBAAAA,MAAY,MAAA,OAAA,qBAAA,mBAAmB,QAAQ;AACxC;;;;"}