{"version":3,"file":"location.js","sources":["utils/location.js"],"sourcesContent":["/**\r\n * ÁôæÂ∫¶Âú∞ÂõæÂÆö‰ΩçÂ∑•ÂÖ∑Á±ª\r\n * Âü∫‰∫éÁôæÂ∫¶Âú∞ÂõæÂæÆ‰ø°Â∞èÁ®ãÂ∫èJS SDKÂ∞ÅË£Ö\r\n */\r\nimport { BAIDU_MAP_AK } from './config.js'\r\n// ÂØºÂÖ•ÁôæÂ∫¶ SDK\r\nimport { BMapWX } from '@/libs/bmap-wx.js'\r\n\r\n/**\r\n * Ëé∑ÂèñÂΩìÂâç‰ΩçÁΩÆ‰ø°ÊÅØ (È´òÁ≤æÂ∫¶)\r\n * @returns {Promise} ËøîÂõûÂåÖÂê´ÁªèÁ∫¨Â∫¶ÂíåÂú∞ÂùÄ‰ø°ÊÅØÁöÑ Promise\r\n */\r\nexport function getBaiduLocation() {\r\n    return new Promise((resolve, reject) => {\r\n        // 1. ÂàùÂßãÂåñÁôæÂ∫¶Âú∞ÂõæÂØπË±°\r\n        const BMap = new BMapWX({\r\n            ak: BAIDU_MAP_AK\r\n        })\r\n\r\n        console.log('üì° ÂºÄÂßãËé∑ÂèñÁ≥ªÁªüÈ´òÁ≤æÂ∫¶ÂÆö‰Ωç...')\r\n\r\n        // ÂÖà‰ΩøÁî® uni.getLocation Ëé∑ÂèñÈ´òÁ≤æÂ∫¶ÁªèÁ∫¨Â∫¶ÔºåÂÜç‰º†ÁªôÁôæÂ∫¶ËøõË°åÈÄÜÂú∞ÁêÜÁºñÁ†Å\r\n        uni.getLocation({\r\n            type: 'gcj02',\r\n            isHighAccuracy: true,\r\n            highAccuracyExpireTime: 3000,\r\n            success: (locRes) => {\r\n                console.log('üõ∞Ô∏è Á≥ªÁªüÂÆö‰ΩçÊàêÂäü:', locRes)\r\n                const locationStr = `${locRes.latitude},${locRes.longitude}`\r\n\r\n                // 2. Â∞ÜÈ´òÁ≤æÂ∫¶ÁªèÁ∫¨Â∫¶‰º†ÁªôÁôæÂ∫¶ SDK ËøõË°åÈÄÜÂú∞ÁêÜÁºñÁ†Å\r\n                BMap.regeocoding({\r\n                    location: locationStr, // ÂÖ≥ÈîÆÔºö‰º†ÂÖ•ÁªèÁ∫¨Â∫¶ÔºåË∑≥Ëøá SDK ÂÜÖÈÉ®ÁöÑÂÆö‰ΩçËé∑Âèñ\r\n                    fail: (err) => {\r\n                        console.error('‚ùå ÁôæÂ∫¶Âú∞ÂõæËß£ÊûêÂú∞ÂùÄÂ§±Ë¥•:', err)\r\n                        reject(err)\r\n                    },\r\n                    success: (res) => {\r\n                        console.log('‚úÖ ÁôæÂ∫¶Âú∞ÂõæËß£ÊûêÊàêÂäü:', res)\r\n\r\n                        if (res.wxMarkerData && res.wxMarkerData.length > 0) {\r\n                            const locationData = res.wxMarkerData[0]\r\n\r\n                            const result = {\r\n                                latitude: locRes.latitude,\r\n                                longitude: locRes.longitude,\r\n                                address: res.originalData.result.formatted_address,\r\n                                addressComponent: res.originalData.result.addressComponent,\r\n                                business: res.originalData.result.business,\r\n                                pois: res.originalData.result.pois\r\n                            }\r\n\r\n                            // ‰ºòÂÖà‰ΩøÁî®ËØ≠‰πâÂåñÊèèËø∞\r\n                            let displayName = result.address\r\n                            if (res.originalData.result.sematic_description) {\r\n                                displayName = res.originalData.result.sematic_description\r\n                            }\r\n\r\n                            result.displayName = displayName\r\n                            resolve(result)\r\n                        } else {\r\n                            reject(new Error('Êú™Ëé∑ÂèñÂà∞‰ΩçÁΩÆËØ¶ÊÉÖ'))\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            fail: (err) => {\r\n                console.error('‚ùå Á≥ªÁªüÂÆö‰ΩçËé∑ÂèñÂ§±Ë¥•:', err)\r\n                reject(err)\r\n            }\r\n        })\r\n    })\r\n}\r\n"],"names":["BMapWX","BAIDU_MAP_AK","uni"],"mappings":";;;;AAYO,SAAS,mBAAmB;AAC/B,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEpC,UAAM,OAAO,IAAIA,mBAAO;AAAA,MACpB,IAAIC,aAAY;AAAA,IAC5B,CAAS;AAEDC,kBAAAA,MAAA,MAAA,OAAA,2BAAY,mBAAmB;AAG/BA,kBAAAA,MAAI,YAAY;AAAA,MACZ,MAAM;AAAA,MACN,gBAAgB;AAAA,MAChB,wBAAwB;AAAA,MACxB,SAAS,CAAC,WAAW;AACjBA,sBAAAA,MAAA,MAAA,OAAA,2BAAY,eAAe,MAAM;AACjC,cAAM,cAAc,GAAG,OAAO,QAAQ,IAAI,OAAO,SAAS;AAG1D,aAAK,YAAY;AAAA,UACb,UAAU;AAAA;AAAA,UACV,MAAM,CAAC,QAAQ;AACXA,0BAAAA,MAAc,MAAA,SAAA,2BAAA,iBAAiB,GAAG;AAClC,mBAAO,GAAG;AAAA,UACb;AAAA,UACD,SAAS,CAAC,QAAQ;AACdA,0BAAAA,MAAA,MAAA,OAAA,2BAAY,eAAe,GAAG;AAE9B,gBAAI,IAAI,gBAAgB,IAAI,aAAa,SAAS,GAAG;AAC5B,kBAAI,aAAa,CAAC;AAEvC,oBAAM,SAAS;AAAA,gBACX,UAAU,OAAO;AAAA,gBACjB,WAAW,OAAO;AAAA,gBAClB,SAAS,IAAI,aAAa,OAAO;AAAA,gBACjC,kBAAkB,IAAI,aAAa,OAAO;AAAA,gBAC1C,UAAU,IAAI,aAAa,OAAO;AAAA,gBAClC,MAAM,IAAI,aAAa,OAAO;AAAA,cACjC;AAGD,kBAAI,cAAc,OAAO;AACzB,kBAAI,IAAI,aAAa,OAAO,qBAAqB;AAC7C,8BAAc,IAAI,aAAa,OAAO;AAAA,cACzC;AAED,qBAAO,cAAc;AACrB,sBAAQ,MAAM;AAAA,YAC1C,OAA+B;AACH,qBAAO,IAAI,MAAM,UAAU,CAAC;AAAA,YAC/B;AAAA,UACJ;AAAA,QACrB,CAAiB;AAAA,MACJ;AAAA,MACD,MAAM,CAAC,QAAQ;AACXA,sBAAAA,MAAc,MAAA,SAAA,2BAAA,eAAe,GAAG;AAChC,eAAO,GAAG;AAAA,MACb;AAAA,IACb,CAAS;AAAA,EACT,CAAK;AACL;;"}