{"version":3,"file":"hall.js","sources":["pages/hall/hall.vue","D:/Users/windows/Downloads/HBuilderX.4.85.2025110510/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaGFsbC9oYWxsLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"hall-container\">\r\n    <!-- È™ëÊâãÂØºËà™Ê†è -->\r\n    <rider-nav current-page=\"hall\"></rider-nav>\r\n\r\n    <!-- È°∂ÈÉ®Á≠õÈÄâÊ†è -->\r\n    <view class=\"filter-bar\">\r\n      <view class=\"filter-item\" :class=\"{ active: filterType === 'distance' }\" @tap=\"setFilter('distance')\">\r\n        <text class=\"filter-text\">Ë∑ùÁ¶ªÊúÄËøë</text>\r\n      </view>\r\n      <view class=\"filter-item\" :class=\"{ active: filterType === 'price' }\" @tap=\"setFilter('price')\">\r\n        <text class=\"filter-text\">ÈáëÈ¢ùÊúÄÈ´ò</text>\r\n      </view>\r\n      <view class=\"filter-item\" :class=\"{ active: filterType === 'all' }\" @tap=\"setFilter('all')\">\r\n        <text class=\"filter-text\">ÂÖ®ÈÉ®ËÆ¢Âçï</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- ËÆ¢ÂçïÂàóË°® -->\r\n    <view class=\"order-list\" v-if=\"orderList.length > 0\">\r\n      <view\r\n        class=\"order-card\"\r\n        v-for=\"order in orderList\"\r\n        :key=\"order.id\"\r\n        @tap=\"goToOrderDetail(order.id)\"\r\n      >\r\n        <!-- ËÆ¢ÂçïÁ±ªÂûãÂíå‰ª∑Ê†º -->\r\n        <view class=\"card-header\">\r\n          <view class=\"order-type-badge\" :class=\"'type-' + order.type\">\r\n            {{ order.typeText }}\r\n          </view>\r\n          <view class=\"order-price\">\r\n            <text class=\"price-symbol\">¬•</text>\r\n            <text class=\"price-value\">{{ order.runnerFee }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- Âú∞ÂùÄ‰ø°ÊÅØ -->\r\n        <view class=\"address-section\">\r\n          <view class=\"address-item start\">\r\n            <text class=\"address-icon\">üü¢</text>\r\n            <text class=\"address-text\">{{ order.pickupAddr }}</text>\r\n          </view>\r\n          <view class=\"address-divider\"></view>\r\n          <view class=\"address-item end\">\r\n            <text class=\"address-icon\">üî¥</text>\r\n            <text class=\"address-text\">{{ order.deliveryAddr }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- ËÆ¢Âçï‰ø°ÊÅØ -->\r\n        <view class=\"order-info\">\r\n          <view class=\"info-item\">\r\n            <text class=\"info-icon\">üìç</text>\r\n            <text class=\"info-text\">{{ order.distance }}km</text>\r\n          </view>\r\n          <view class=\"info-item\">\r\n            <text class=\"info-icon\">‚è±Ô∏è</text>\r\n            <text class=\"info-text\">{{ order.createTime }}</text>\r\n          </view>\r\n          <view class=\"info-item\">\r\n            <text class=\"info-icon\">üì¶</text>\r\n            <text class=\"info-text\">{{ order.goodsDesc }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- Êìç‰ΩúÊåâÈíÆ -->\r\n        <view class=\"card-footer\">\r\n          <button class=\"grab-btn\" @tap.stop=\"grabOrder(order.id)\">\r\n            Á´ãÂç≥Êé•Âçï\r\n          </button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- Á©∫Áä∂ÊÄÅ -->\r\n    <view class=\"empty-state\" v-else>\r\n      <text class=\"empty-icon\">üì¶</text>\r\n      <text class=\"empty-text\">ÊöÇÊó†ÂèØÊé•ËÆ¢Âçï</text>\r\n      <text class=\"empty-tip\">Âà∑Êñ∞ÁúãÁúãÂêß~</text>\r\n    </view>\r\n\r\n    <!-- Âà∑Êñ∞ÊåâÈíÆ -->\r\n    <view class=\"refresh-btn\" @tap=\"loadOrders\">\r\n      <text class=\"refresh-icon\">üîÑ</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { grabOrder, getOrderPool } from '@/api/rider.js';\r\nimport RiderNav from '@/components/rider-nav/rider-nav.vue';\r\n\r\nexport default {\r\n  components: {\r\n    RiderNav\r\n  },\r\n  data() {\r\n    return {\r\n      filterType: 'distance', // distance, price, all\r\n      orderList: [],\r\n      loading: false\r\n    };\r\n  },\r\n\r\n  onLoad() {\r\n    this.loadOrders();\r\n  },\r\n\r\n  onPullDownRefresh() {\r\n    this.loadOrders();\r\n    setTimeout(() => {\r\n      uni.stopPullDownRefresh();\r\n    }, 1000);\r\n  },\r\n\r\n  methods: {\r\n    // Âä†ËΩΩËÆ¢ÂçïÂàóË°®\r\n    async loadOrders() {\r\n      if (this.loading) return;\r\n\r\n      try {\r\n        this.loading = true;\r\n\r\n        // Ë∞ÉÁî®ÂêéÁ´ØAPIËé∑ÂèñÂæÖÊé•ÂçïÂàóË°®ÔºàÊé•ÂçïÊ±†Ôºâ\r\n        const result = await getOrderPool({\r\n          page: 1,\r\n          size: 20\r\n        });\r\n\r\n        if (result.data && result.data.records) {\r\n          // Ê†ºÂºèÂåñËÆ¢ÂçïÊï∞ÊçÆ\r\n          this.orderList = result.data.records.map(order => ({\r\n            id: order.orderId || order.id,\r\n            type: order.serviceType || order.type,\r\n            typeText: this.getTypeText(order.serviceType || order.type),\r\n            pickupAddr: order.pickupAddr || (order.addressInfo && order.addressInfo.pickupAddress) || '',\r\n            deliveryAddr: order.deliveryAddr || (order.addressInfo && order.addressInfo.deliveryAddress) || '',\r\n            distance: order.distance || 0,\r\n            runnerFee: order.runnerFee || order.totalAmount,\r\n            goodsDesc: order.goodsDesc || order.goodsInfo,\r\n            createTime: this.formatTime(order.createTime)\r\n          }));\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Ëé∑ÂèñËÆ¢ÂçïÂàóË°®Â§±Ë¥•:', error);\r\n        // Â¶ÇÊûúAPIË∞ÉÁî®Â§±Ë¥•ÔºåÊòæÁ§∫Á©∫ÂàóË°®ÊàñÁ§∫‰æãÊï∞ÊçÆ\r\n        this.orderList = [];\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    // Ëé∑ÂèñËÆ¢ÂçïÁ±ªÂûãÊñáÊú¨\r\n    getTypeText(type) {\r\n      const typeMap = {\r\n        1: 'Â∏Æ‰π∞',\r\n        2: 'Â∏ÆÈÄÅ',\r\n        3: 'Â∏ÆÂèñ',\r\n        4: 'ÂÖ®ËÉΩ'\r\n      };\r\n      return typeMap[type] || 'Êú™Áü•';\r\n    },\r\n\r\n    // Ê†ºÂºèÂåñÊó∂Èó¥\r\n    formatTime(time) {\r\n      if (!time) return '';\r\n\r\n      const now = new Date();\r\n      const createTime = new Date(time);\r\n      const diff = Math.floor((now - createTime) / 1000 / 60); // ÂàÜÈíüÂ∑Æ\r\n\r\n      if (diff < 1) return 'ÂàöÂàö';\r\n      if (diff < 60) return `${diff}ÂàÜÈíüÂâç`;\r\n      if (diff < 1440) return `${Math.floor(diff / 60)}Â∞èÊó∂Ââç`;\r\n      return `${Math.floor(diff / 1440)}Â§©Ââç`;\r\n    },\r\n\r\n    // ËÆæÁΩÆÁ≠õÈÄâÁ±ªÂûã\r\n    setFilter(type) {\r\n      this.filterType = type;\r\n      this.loadOrders();\r\n    },\r\n\r\n    // Êé•Âçï\r\n    async grabOrder(orderId) {\r\n      uni.showModal({\r\n        title: 'Á°ÆËÆ§Êé•Âçï',\r\n        content: 'Á°ÆÂÆöË¶ÅÊé•Ëøô‰∏™ËÆ¢ÂçïÂêóÔºü',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            try {\r\n              uni.showLoading({ title: 'Êé•Âçï‰∏≠...', mask: true });\r\n\r\n              await grabOrder(orderId);\r\n\r\n              uni.hideLoading();\r\n\r\n              uni.showToast({\r\n                title: 'Êé•ÂçïÊàêÂäü',\r\n                icon: 'success'\r\n              });\r\n\r\n              // Ë∑≥ËΩ¨Âà∞ÈÖçÈÄÅ‰∏≠È°µÈù¢\r\n              setTimeout(() => {\r\n                uni.redirectTo({\r\n                  url: '/pages/running/running'\r\n                });\r\n              }, 1500);\r\n\r\n            } catch (error) {\r\n              uni.hideLoading();\r\n              console.error('Êé•ÂçïÂ§±Ë¥•:', error);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    // Êü•ÁúãËÆ¢ÂçïËØ¶ÊÉÖ\r\n    goToOrderDetail(orderId) {\r\n      uni.navigateTo({\r\n        url: `/pages/order/detail?id=${orderId}`\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.hall-container {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n  padding-bottom: 120rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n/* Á≠õÈÄâÊ†è */\r\n.filter-bar {\r\n  display: flex;\r\n  background: #fff;\r\n  padding: 20rpx;\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 50;\r\n}\r\n\r\n.filter-item {\r\n  flex: 1;\r\n  text-align: center;\r\n  padding: 16rpx 0;\r\n  margin: 0 10rpx;\r\n  border-radius: 8rpx;\r\n  background: #f5f5f5;\r\n}\r\n\r\n.filter-item.active {\r\n  background: #07c160;\r\n}\r\n\r\n.filter-text {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.filter-item.active .filter-text {\r\n  color: #fff;\r\n}\r\n\r\n/* ËÆ¢ÂçïÂàóË°® */\r\n.order-list {\r\n  padding: 20rpx;\r\n}\r\n\r\n.order-card {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 20rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.order-type-badge {\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 8rpx;\r\n  font-size: 24rpx;\r\n  font-weight: bold;\r\n}\r\n\r\n.type-1 {\r\n  background: #fff7e6;\r\n  color: #fa8c16;\r\n}\r\n\r\n.type-2 {\r\n  background: #e6f7ff;\r\n  color: #1890ff;\r\n}\r\n\r\n.type-3 {\r\n  background: #f6ffed;\r\n  color: #52c41a;\r\n}\r\n\r\n.type-4 {\r\n  background: #fff0f6;\r\n  color: #eb2f96;\r\n}\r\n\r\n.order-price {\r\n  display: flex;\r\n  align-items: baseline;\r\n}\r\n\r\n.price-symbol {\r\n  font-size: 24rpx;\r\n  color: #ff4d4f;\r\n  margin-right: 4rpx;\r\n}\r\n\r\n.price-value {\r\n  font-size: 40rpx;\r\n  font-weight: bold;\r\n  color: #ff4d4f;\r\n}\r\n\r\n/* Âú∞ÂùÄ‰ø°ÊÅØ */\r\n.address-section {\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.address-item {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.address-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.address-icon {\r\n  font-size: 32rpx;\r\n  margin-right: 12rpx;\r\n}\r\n\r\n.address-text {\r\n  flex: 1;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  line-height: 1.5;\r\n}\r\n\r\n.address-divider {\r\n  height: 2rpx;\r\n  background: #f5f5f5;\r\n  margin: 16rpx 0 16rpx 44rpx;\r\n}\r\n\r\n/* ËÆ¢Âçï‰ø°ÊÅØ */\r\n.order-info {\r\n  display: flex;\r\n  margin-bottom: 24rpx;\r\n  padding: 20rpx;\r\n  background: #f5f5f5;\r\n  border-radius: 12rpx;\r\n}\r\n\r\n.info-item {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.info-icon {\r\n  font-size: 32rpx;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.info-text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n/* Â∫ïÈÉ®ÊåâÈíÆ */\r\n.card-footer {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.grab-btn {\r\n  width: 240rpx;\r\n  height: 72rpx;\r\n  line-height: 72rpx;\r\n  border-radius: 36rpx;\r\n  background: #07c160;\r\n  color: #fff;\r\n  font-size: 30rpx;\r\n  font-weight: bold;\r\n}\r\n\r\n.grab-btn::after {\r\n  border: none;\r\n}\r\n\r\n/* Á©∫Áä∂ÊÄÅ */\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding-top: 200rpx;\r\n}\r\n\r\n.empty-icon {\r\n  font-size: 150rpx;\r\n  margin-bottom: 30rpx;\r\n  opacity: 0.5;\r\n}\r\n\r\n.empty-text {\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.empty-tip {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n}\r\n\r\n/* Âà∑Êñ∞ÊåâÈíÆ */\r\n.refresh-btn {\r\n  position: fixed;\r\n  right: 40rpx;\r\n  bottom: 120rpx;\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n  border-radius: 50rpx;\r\n  background: #07c160;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  box-shadow: 0 8rpx 16rpx rgba(7, 193, 96, 0.3);\r\n}\r\n\r\n.refresh-icon {\r\n  font-size: 50rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/Delivery Service Platform/uniapp/pages/hall/hall.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getOrderPool","grabOrder"],"mappings":"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"}