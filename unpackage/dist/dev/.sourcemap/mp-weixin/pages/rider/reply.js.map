{"version":3,"file":"reply.js","sources":["pages/rider/reply.vue","D:/Users/windows/Downloads/HBuilderX.4.85.2025110510/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmlkZXIvcmVwbHkudnVl"],"sourcesContent":["<template>\r\n  <view class=\"reply-container\">\r\n    <!-- 顶部导航栏 -->\r\n    <view class=\"nav-bar\">\r\n      <view class=\"nav-back\" @click=\"goBack\">\r\n        <text class=\"back-icon\">←</text>\r\n      </view>\r\n      <view class=\"nav-title\">回复评价</view>\r\n      <view class=\"nav-placeholder\"></view>\r\n    </view>\r\n\r\n    <!-- 评价信息 -->\r\n    <scroll-view class=\"content\" scroll-y>\r\n      <!-- 用户评价 -->\r\n      <view class=\"evaluation-card\" v-if=\"evaluationInfo\">\r\n        <view class=\"card-header\">\r\n          <text class=\"header-title\">用户评价</text>\r\n          <view class=\"rating-stars\">\r\n            <text\r\n              class=\"star-icon\"\r\n              v-for=\"(star, index) in 5\"\r\n              :key=\"index\"\r\n            >\r\n              {{ index < evaluationInfo.rating ? '★' : '☆' }}\r\n            </text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"evaluation-tags\" v-if=\"getTags().length > 0\">\r\n          <view\r\n            class=\"tag-item\"\r\n            v-for=\"(tag, index) in getTags()\"\r\n            :key=\"index\"\r\n          >\r\n            {{ tag }}\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"evaluation-content\">\r\n          <text class=\"feedback-text\">{{ getFeedbackText() }}</text>\r\n        </view>\r\n\r\n        <view class=\"evaluation-time\">\r\n          <text>{{ formatTime(evaluationInfo.evaluationTime) }}</text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 回复输入 -->\r\n      <view class=\"reply-section\">\r\n        <view class=\"section-title\">\r\n          <text class=\"title-text\">您的回复</text>\r\n          <text class=\"title-tip\">{{ replyContent.length }}/200</text>\r\n        </view>\r\n        <textarea\r\n          class=\"reply-input\"\r\n          v-model=\"replyContent\"\r\n          placeholder=\"感谢您的评价，我会继续努力提供优质服务~\"\r\n          maxlength=\"200\"\r\n          :show-confirm-bar=\"false\"\r\n        ></textarea>\r\n\r\n        <!-- 快捷回复 -->\r\n        <view class=\"quick-replies\">\r\n          <view class=\"quick-title\">快捷回复：</view>\r\n          <view class=\"quick-list\">\r\n            <view\r\n              class=\"quick-item\"\r\n              v-for=\"(quick, index) in quickReplies\"\r\n              :key=\"index\"\r\n              @click=\"selectQuickReply(quick)\"\r\n            >\r\n              {{ quick }}\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </scroll-view>\r\n\r\n    <!-- 底部提交栏 -->\r\n    <view class=\"bottom-bar\">\r\n      <button class=\"btn-submit\" @click=\"submitReply\" :disabled=\"!replyContent.trim()\">\r\n        提交回复\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { getEvaluationDetail } from '@/api/order.js'\r\nimport { submitRiderReply } from '@/api/rider.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      orderId: null,\r\n      evaluationInfo: null,\r\n      replyContent: '',\r\n      quickReplies: [\r\n        '感谢您的好评，期待再次为您服务！',\r\n        '谢谢您的认可，我会继续努力的！',\r\n        '感谢您的评价，祝您生活愉快！',\r\n        '非常感谢您的理解与支持！',\r\n        '您的满意就是我们最大的动力！'\r\n      ]\r\n    }\r\n  },\r\n\r\n  onLoad(options) {\r\n    if (options.orderId) {\r\n      this.orderId = options.orderId\r\n      this.loadEvaluation()\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    /**\r\n     * 加载评价信息\r\n     */\r\n    async loadEvaluation() {\r\n      try {\r\n        uni.showLoading({ title: '加载中...' })\r\n\r\n        const res = await getEvaluationDetail(this.orderId)\r\n\r\n        uni.hideLoading()\r\n\r\n        if (res.code === 200 && res.data) {\r\n          this.evaluationInfo = res.data\r\n        } else {\r\n          uni.showToast({\r\n            title: '评价信息不存在',\r\n            icon: 'none'\r\n          })\r\n          setTimeout(() => {\r\n            uni.navigateBack()\r\n          }, 1500)\r\n        }\r\n      } catch (error) {\r\n        uni.hideLoading()\r\n        console.error('加载评价失败:', error)\r\n        uni.showToast({\r\n          title: '加载失败，请重试',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 从评价内容中提取标签\r\n     */\r\n    getTags() {\r\n      if (!this.evaluationInfo || !this.evaluationInfo.feedback) return []\r\n\r\n      const feedback = this.evaluationInfo.feedback\r\n      const tagMatch = feedback.match(/\\[(.*?)\\]/)\r\n\r\n      if (tagMatch && tagMatch[1]) {\r\n        return tagMatch[1].split(',').map(tag => tag.trim()).filter(tag => tag)\r\n      }\r\n\r\n      return []\r\n    },\r\n\r\n    /**\r\n     * 获取纯文本评价内容\r\n     */\r\n    getFeedbackText() {\r\n      if (!this.evaluationInfo || !this.evaluationInfo.feedback) return ''\r\n\r\n      let feedback = this.evaluationInfo.feedback\r\n      feedback = feedback.replace(/\\[.*?\\]\\s*/, '')\r\n      return feedback.trim()\r\n    },\r\n\r\n    /**\r\n     * 格式化时间\r\n     */\r\n    formatTime(time) {\r\n      if (!time) return '-'\r\n      const date = new Date(time)\r\n      const year = date.getFullYear()\r\n      const month = String(date.getMonth() + 1).padStart(2, '0')\r\n      const day = String(date.getDate()).padStart(2, '0')\r\n      const hours = String(date.getHours()).padStart(2, '0')\r\n      const minutes = String(date.getMinutes()).padStart(2, '0')\r\n      return `${year}-${month}-${day} ${hours}:${minutes}`\r\n    },\r\n\r\n    /**\r\n     * 选择快捷回复\r\n     */\r\n    selectQuickReply(quick) {\r\n      this.replyContent = quick\r\n    },\r\n\r\n    /**\r\n     * 提交回复\r\n     */\r\n    async submitReply() {\r\n      const content = this.replyContent.trim()\r\n\r\n      if (!content) {\r\n        uni.showToast({\r\n          title: '请输入回复内容',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n\r\n      try {\r\n        uni.showLoading({ title: '提交中...', mask: true })\r\n\r\n        await submitRiderReply({\r\n          orderId: Number(this.orderId),\r\n          riderReply: content\r\n        })\r\n\r\n        uni.hideLoading()\r\n\r\n        uni.showToast({\r\n          title: '回复成功',\r\n          icon: 'success'\r\n        })\r\n\r\n        // 延迟返回上一页\r\n        setTimeout(() => {\r\n          uni.navigateBack()\r\n        }, 1500)\r\n\r\n      } catch (error) {\r\n        uni.hideLoading()\r\n        console.error('回复失败:', error)\r\n        uni.showToast({\r\n          title: error.message || '回复失败，请重试',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 返回上一页\r\n     */\r\n    goBack() {\r\n      uni.navigateBack()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.reply-container {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n/* 导航栏 */\r\n.nav-bar {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  height: 44px;\r\n  padding: 0 15px;\r\n  background-color: #fff;\r\n  border-bottom: 1px solid #eee;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 100;\r\n}\r\n\r\n.nav-back,\r\n.nav-placeholder {\r\n  width: 40px;\r\n  height: 40px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.back-icon {\r\n  font-size: 24px;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.nav-title {\r\n  flex: 1;\r\n  font-size: 17px;\r\n  font-weight: 600;\r\n  color: #333;\r\n  text-align: center;\r\n}\r\n\r\n/* 内容区域 */\r\n.content {\r\n  flex: 1;\r\n  margin-top: 54px;\r\n  margin-bottom: 80px;\r\n  padding: 15px;\r\n  overflow-y: auto;\r\n}\r\n\r\n/* 评价卡片 */\r\n.evaluation-card {\r\n  background: #fff;\r\n  border-radius: 12px;\r\n  padding: 20px;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 16px;\r\n  padding-bottom: 16px;\r\n  border-bottom: 1px solid #f5f5f5;\r\n}\r\n\r\n.header-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.rating-stars {\r\n  display: flex;\r\n  gap: 4px;\r\n}\r\n\r\n.star-icon {\r\n  font-size: 20px;\r\n  color: #ffd700;\r\n}\r\n\r\n.evaluation-tags {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 10px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.tag-item {\r\n  padding: 6px 16px;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  border-radius: 20px;\r\n  font-size: 13px;\r\n  color: #fff;\r\n}\r\n\r\n.evaluation-content {\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.feedback-text {\r\n  font-size: 15px;\r\n  color: #333;\r\n  line-height: 1.6;\r\n}\r\n\r\n.evaluation-time {\r\n  text-align: right;\r\n}\r\n\r\n.evaluation-time text {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n\r\n/* 回复区域 */\r\n.reply-section {\r\n  background: #fff;\r\n  border-radius: 12px;\r\n  padding: 20px;\r\n}\r\n\r\n.section-title {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.title-text {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.title-tip {\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n\r\n.reply-input {\r\n  width: 100%;\r\n  min-height: 120px;\r\n  padding: 12px;\r\n  font-size: 15px;\r\n  color: #333;\r\n  background-color: #f5f5f5;\r\n  border-radius: 8px;\r\n  border: none;\r\n  resize: none;\r\n  line-height: 1.6;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n/* 快捷回复 */\r\n.quick-replies {\r\n  margin-top: 16px;\r\n}\r\n\r\n.quick-title {\r\n  font-size: 14px;\r\n  color: #666;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.quick-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 10px;\r\n}\r\n\r\n.quick-item {\r\n  padding: 8px 16px;\r\n  background: #f0f7ff;\r\n  color: #1890ff;\r\n  font-size: 13px;\r\n  border-radius: 20px;\r\n  border: 1px solid #1890ff;\r\n}\r\n\r\n/* 底部提交栏 */\r\n.bottom-bar {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  padding: 15px;\r\n  background-color: #fff;\r\n  border-top: 1px solid #eee;\r\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.btn-submit {\r\n  width: 100%;\r\n  height: 48px;\r\n  line-height: 48px;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  color: #fff;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  border-radius: 24px;\r\n  border: none;\r\n}\r\n\r\n.btn-submit[disabled] {\r\n  background: #ccc;\r\n  color: #999;\r\n}\r\n\r\n.btn-submit::after {\r\n  border: none;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/Delivery Service Platform/uniapp/pages/rider/reply.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getEvaluationDetail","submitRiderReply"],"mappings":";;;;AA2FA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,SAAS;AAAA,MACT,gBAAgB;AAAA,MAChB,cAAc;AAAA,MACd,cAAc;AAAA,QACZ;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACD;AAAA,EAED,OAAO,SAAS;AACd,QAAI,QAAQ,SAAS;AACnB,WAAK,UAAU,QAAQ;AACvB,WAAK,eAAe;AAAA,IACtB;AAAA,EACD;AAAA,EAED,SAAS;AAAA;AAAA;AAAA;AAAA,IAIP,MAAM,iBAAiB;AACrB,UAAI;AACFA,sBAAAA,MAAI,YAAY,EAAE,OAAO,UAAU;AAEnC,cAAM,MAAM,MAAMC,8BAAoB,KAAK,OAAO;AAElDD,sBAAAA,MAAI,YAAY;AAEhB,YAAI,IAAI,SAAS,OAAO,IAAI,MAAM;AAChC,eAAK,iBAAiB,IAAI;AAAA,eACrB;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,WACP;AACD,qBAAW,MAAM;AACfA,0BAAAA,MAAI,aAAa;AAAA,UAClB,GAAE,IAAI;AAAA,QACT;AAAA,MACA,SAAO,OAAO;AACdA,sBAAAA,MAAI,YAAY;AAChBA,sBAAAA,MAAA,MAAA,SAAA,gCAAc,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AAAA,MACH;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,UAAU;AACR,UAAI,CAAC,KAAK,kBAAkB,CAAC,KAAK,eAAe;AAAU,eAAO,CAAC;AAEnE,YAAM,WAAW,KAAK,eAAe;AACrC,YAAM,WAAW,SAAS,MAAM,WAAW;AAE3C,UAAI,YAAY,SAAS,CAAC,GAAG;AAC3B,eAAO,SAAS,CAAC,EAAE,MAAM,GAAG,EAAE,IAAI,SAAO,IAAI,KAAM,CAAA,EAAE,OAAO,SAAO,GAAG;AAAA,MACxE;AAEA,aAAO,CAAC;AAAA,IACT;AAAA;AAAA;AAAA;AAAA,IAKD,kBAAkB;AAChB,UAAI,CAAC,KAAK,kBAAkB,CAAC,KAAK,eAAe;AAAU,eAAO;AAElE,UAAI,WAAW,KAAK,eAAe;AACnC,iBAAW,SAAS,QAAQ,cAAc,EAAE;AAC5C,aAAO,SAAS,KAAK;AAAA,IACtB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW,MAAM;AACf,UAAI,CAAC;AAAM,eAAO;AAClB,YAAM,OAAO,IAAI,KAAK,IAAI;AAC1B,YAAM,OAAO,KAAK,YAAY;AAC9B,YAAM,QAAQ,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AACzD,YAAM,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,YAAM,QAAQ,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AACrD,YAAM,UAAU,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AACzD,aAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,OAAO;AAAA,IACnD;AAAA;AAAA;AAAA;AAAA,IAKD,iBAAiB,OAAO;AACtB,WAAK,eAAe;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,cAAc;AAClB,YAAM,UAAU,KAAK,aAAa,KAAK;AAEvC,UAAI,CAAC,SAAS;AACZA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AACD;AAAA,MACF;AAEA,UAAI;AACFA,sBAAG,MAAC,YAAY,EAAE,OAAO,UAAU,MAAM,MAAM;AAE/C,cAAME,2BAAiB;AAAA,UACrB,SAAS,OAAO,KAAK,OAAO;AAAA,UAC5B,YAAY;AAAA,SACb;AAEDF,sBAAAA,MAAI,YAAY;AAEhBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AAGD,mBAAW,MAAM;AACfA,wBAAAA,MAAI,aAAa;AAAA,QAClB,GAAE,IAAI;AAAA,MAEP,SAAO,OAAO;AACdA,sBAAAA,MAAI,YAAY;AAChBA,sBAAAA,MAAc,MAAA,SAAA,gCAAA,SAAS,KAAK;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO,MAAM,WAAW;AAAA,UACxB,MAAM;AAAA,SACP;AAAA,MACH;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAKD,SAAS;AACPA,oBAAAA,MAAI,aAAa;AAAA,IACnB;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrPA,GAAG,WAAW,eAAe;"}