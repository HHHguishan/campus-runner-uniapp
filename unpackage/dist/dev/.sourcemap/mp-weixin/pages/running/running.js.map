{"version":3,"file":"running.js","sources":["pages/running/running.vue","D:/Users/windows/Downloads/HBuilderX.4.85.2025110510/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcnVubmluZy9ydW5uaW5nLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"running-container\">\r\n    <!-- È™ëÊâãÂØºËà™Ê†è -->\r\n    <rider-nav current-page=\"running\"></rider-nav>\r\n\r\n    <!-- ÂΩìÂâçÈÖçÈÄÅËÆ¢Âçï -->\r\n    <view class=\"current-order\" v-if=\"currentOrder\">\r\n      <view class=\"order-header\">\r\n        <text class=\"header-title\">üì¶ ÂΩìÂâçÈÖçÈÄÅ</text>\r\n        <text class=\"order-status\">ÈÖçÈÄÅ‰∏≠</text>\r\n      </view>\r\n\r\n      <!-- ËøõÂ∫¶Êù° -->\r\n      <view class=\"progress-bar\">\r\n        <view class=\"progress-step active\">\r\n          <view class=\"step-icon\">‚úì</view>\r\n          <text class=\"step-text\">Â∑≤Êé•Âçï</text>\r\n        </view>\r\n        <view class=\"progress-line active\"></view>\r\n        <view class=\"progress-step active\">\r\n          <view class=\"step-icon\">2</view>\r\n          <text class=\"step-text\">ÈÖçÈÄÅ‰∏≠</text>\r\n        </view>\r\n        <view class=\"progress-line\"></view>\r\n        <view class=\"progress-step\">\r\n          <view class=\"step-icon\">3</view>\r\n          <text class=\"step-text\">Â∑≤ÂÆåÊàê</text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- ËÆ¢Âçï‰ø°ÊÅØ -->\r\n      <view class=\"order-info-card\">\r\n        <view class=\"info-section\">\r\n          <view class=\"section-title\">üìç ÈÖçÈÄÅÂú∞ÂùÄ</view>\r\n          <view class=\"address-item\">\r\n            <text class=\"addr-label\">ÂèñË¥ßÂú∞ÂùÄ</text>\r\n            <text class=\"addr-value\">{{ currentOrder.pickupAddr }}</text>\r\n          </view>\r\n          <view class=\"address-item\">\r\n            <text class=\"addr-label\">ÈÄÅË¥ßÂú∞ÂùÄ</text>\r\n            <text class=\"addr-value\">{{ currentOrder.deliveryAddr }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"info-section\">\r\n          <view class=\"section-title\">üìû ËÅîÁ≥ª‰ø°ÊÅØ</view>\r\n          <view class=\"contact-item\">\r\n            <text class=\"contact-label\">ËÅîÁ≥ª‰∫∫</text>\r\n            <text class=\"contact-value\">{{ currentOrder.contactName }}</text>\r\n          </view>\r\n          <view class=\"contact-item\">\r\n            <text class=\"contact-label\">ËÅîÁ≥ªÁîµËØù</text>\r\n            <text class=\"contact-value\">{{ currentOrder.contactPhone }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- Êìç‰ΩúÊåâÈíÆ -->\r\n      <view class=\"action-buttons\">\r\n        <button class=\"action-btn call-btn\" @tap=\"makeCall\">\r\n          <text class=\"btn-icon\">üìû</text>\r\n          <text>Êã®ÊâìÁîµËØù</text>\r\n        </button>\r\n        <button class=\"action-btn finish-btn\" @tap=\"finishOrder\">\r\n          <text class=\"btn-icon\">‚úÖ</text>\r\n          <text>ÂÆåÊàêÈÖçÈÄÅ</text>\r\n        </button>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- Á©∫Áä∂ÊÄÅ -->\r\n    <view class=\"empty-state\" v-else>\r\n      <text class=\"empty-icon\">üì¶</text>\r\n      <text class=\"empty-title\">ÊöÇÊó†ÈÖçÈÄÅËÆ¢Âçï</text>\r\n      <text class=\"empty-desc\">Âø´ÂéªÊé•ÂçïÂ§ßÂéÖÁúãÁúãÂêß~</text>\r\n      <button class=\"go-hall-btn\" @tap=\"goToHall\">ÂâçÂæÄÊé•ÂçïÂ§ßÂéÖ</button>\r\n    </view>\r\n\r\n    <!-- ‰ªäÊó•ÁªüËÆ° -->\r\n    <view class=\"stats-card\">\r\n      <view class=\"stats-header\">\r\n        <text class=\"stats-title\">üìä ‰ªäÊó•ÁªüËÆ°</text>\r\n      </view>\r\n      <view class=\"stats-content\">\r\n        <view class=\"stat-item\">\r\n          <text class=\"stat-value\">{{ todayStats.completedOrders || 0 }}</text>\r\n          <text class=\"stat-label\">ÂÆåÊàêÂçïÊï∞</text>\r\n        </view>\r\n        <view class=\"stat-divider\"></view>\r\n        <view class=\"stat-item\">\r\n          <text class=\"stat-value\">¬•{{ todayStats.todayEarnings || 0 }}</text>\r\n          <text class=\"stat-label\">‰ªäÊó•Êî∂ÂÖ•</text>\r\n        </view>\r\n        <view class=\"stat-divider\"></view>\r\n        <view class=\"stat-item\">\r\n          <text class=\"stat-value\">{{ todayStats.rating || 5.0 }}</text>\r\n          <text class=\"stat-label\">ËØÑÂàÜ</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { finishOrder, getRiderOrders, getRiderDashboard } from '@/api/rider.js';\r\nimport RiderNav from '@/components/rider-nav/rider-nav.vue';\r\n\r\nexport default {\r\n  components: {\r\n    RiderNav\r\n  },\r\n  data() {\r\n    return {\r\n      currentOrder: null, // ÂΩìÂâçÈÖçÈÄÅËÆ¢Âçï\r\n      todayStats: {\r\n        completedOrders: 8,\r\n        todayEarnings: '125.50',\r\n        rating: 4.9\r\n      }\r\n    };\r\n  },\r\n\r\n  onLoad() {\r\n    this.loadCurrentOrder();\r\n    this.loadTodayStats();\r\n  },\r\n\r\n  onShow() {\r\n    // ÊØèÊ¨°ÊòæÁ§∫Êó∂Âà∑Êñ∞Êï∞ÊçÆ\r\n    this.loadCurrentOrder();\r\n  },\r\n\r\n  methods: {\r\n    // Âä†ËΩΩÂΩìÂâçÈÖçÈÄÅËÆ¢Âçï\r\n    async loadCurrentOrder() {\r\n      try {\r\n        // Ë∞ÉÁî®ÂêéÁ´ØAPIËé∑ÂèñÂΩìÂâçÈÖçÈÄÅ‰∏≠ÁöÑËÆ¢ÂçïÔºàÁä∂ÊÄÅ=2ÔºåÈÖçÈÄÅ‰∏≠Ôºâ\r\n        const result = await getRiderOrders({\r\n          page: 1,\r\n          size: 1,\r\n          status: 2 // ÈÖçÈÄÅ‰∏≠\r\n        });\r\n\r\n        if (result.data && result.data.records && result.data.records.length > 0) {\r\n          const order = result.data.records[0];\r\n          this.currentOrder = {\r\n            id: order.id,\r\n            pickupAddr: order.pickupAddr,\r\n            deliveryAddr: order.deliveryAddr,\r\n            contactName: order.contactName,\r\n            contactPhone: order.contactPhone,\r\n            goodsDesc: order.goodsDesc\r\n          };\r\n        } else {\r\n          this.currentOrder = null;\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Ëé∑ÂèñÂΩìÂâçËÆ¢ÂçïÂ§±Ë¥•:', error);\r\n        this.currentOrder = null;\r\n      }\r\n    },\r\n\r\n    // Âä†ËΩΩ‰ªäÊó•ÁªüËÆ°\r\n    async loadTodayStats() {\r\n      try {\r\n        // Ë∞ÉÁî®ÂêéÁ´ØAPIËé∑Âèñ‰ªäÊó•ÁªüËÆ°Êï∞ÊçÆ\r\n        const result = await getRiderDashboard();\r\n\r\n        if (result.data) {\r\n          this.todayStats = {\r\n            completedOrders: result.data.todayCompletedOrders || 0,\r\n            todayEarnings: result.data.todayIncome || '0.00',\r\n            rating: result.data.averageRating || '5.0'\r\n          };\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Ëé∑ÂèñÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•:', error);\r\n      }\r\n    },\r\n\r\n    // Êã®ÊâìÁîµËØù\r\n    makeCall() {\r\n      if (!this.currentOrder) return;\r\n\r\n      uni.makePhoneCall({\r\n        phoneNumber: this.currentOrder.contactPhone\r\n      });\r\n    },\r\n\r\n    // ÂÆåÊàêÈÖçÈÄÅ\r\n    async handleFinish() {\r\n      if (!this.currentOrder) return;\r\n\r\n      // ÂÖà‰∏ä‰º†ÂÆåÊàêÂá≠ËØÅÂõæÁâá\r\n      uni.chooseImage({\r\n        count: 1,\r\n        success: (res) => {\r\n          const tempFilePath = res.tempFilePaths[0];\r\n          this.confirmFinish(tempFilePath);\r\n        }\r\n      });\r\n    },\r\n\r\n    // Á°ÆËÆ§ÂÆåÊàê\r\n    async confirmFinish(imagePath) {\r\n      try {\r\n        uni.showLoading({ title: '‰∏ä‰º†‰∏≠...', mask: true });\r\n\r\n        // TODO: ‰∏ä‰º†ÂõæÁâá\r\n        const finishImg = imagePath;\r\n\r\n        await finishOrder({\r\n          orderId: this.currentOrder.id,\r\n          finishImg: finishImg\r\n        });\r\n\r\n        uni.hideLoading();\r\n\r\n        uni.showToast({\r\n          title: 'ÈÖçÈÄÅÂÆåÊàê',\r\n          icon: 'success'\r\n        });\r\n\r\n        // Âà∑Êñ∞Êï∞ÊçÆ\r\n        setTimeout(() => {\r\n          this.loadCurrentOrder();\r\n          this.loadTodayStats();\r\n        }, 1500);\r\n\r\n      } catch (error) {\r\n        uni.hideLoading();\r\n        console.error('ÂÆåÊàêÈÖçÈÄÅÂ§±Ë¥•:', error);\r\n      }\r\n    },\r\n\r\n    // ÂÆåÊàêËÆ¢ÂçïÔºàË∑≥ËΩ¨Âà∞‰∏ä‰º†ÂõæÁâáÈ°µÈù¢Ôºâ\r\n    finishOrder() {\r\n      if (!this.currentOrder) return;\r\n\r\n      // Â∞ÜËÆ¢Âçï‰ø°ÊÅØÁºñÁ†ÅÂêé‰º†ÈÄíÁªô‰∏ä‰º†È°µÈù¢\r\n      const orderInfo = encodeURIComponent(JSON.stringify({\r\n        deliveryAddr: this.currentOrder.deliveryAddr\r\n      }));\r\n\r\n      uni.navigateTo({\r\n        url: `/pages/upload-finish/upload-finish?orderId=${this.currentOrder.id}&orderInfo=${orderInfo}`\r\n      });\r\n    },\r\n\r\n    // ÂâçÂæÄÊé•ÂçïÂ§ßÂéÖ\r\n    goToHall() {\r\n      uni.switchTab({\r\n        url: '/pages/hall/hall'\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.running-container {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n  padding-bottom: 120rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n/* ÂΩìÂâçËÆ¢Âçï */\r\n.current-order {\r\n  margin: 20rpx;\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.order-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 30rpx;\r\n  border-bottom: 2rpx solid #f5f5f5;\r\n}\r\n\r\n.header-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.order-status {\r\n  font-size: 28rpx;\r\n  color: #07c160;\r\n  font-weight: bold;\r\n}\r\n\r\n/* ËøõÂ∫¶Êù° */\r\n.progress-bar {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40rpx 30rpx;\r\n  background: linear-gradient(135deg, #07c160 0%, #06ad56 100%);\r\n}\r\n\r\n.progress-step {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.step-icon {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  border-radius: 30rpx;\r\n  background: rgba(255, 255, 255, 0.3);\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.progress-step.active .step-icon {\r\n  background: #fff;\r\n  color: #07c160;\r\n}\r\n\r\n.step-text {\r\n  font-size: 24rpx;\r\n  color: #fff;\r\n}\r\n\r\n.progress-line {\r\n  width: 80rpx;\r\n  height: 4rpx;\r\n  background: rgba(255, 255, 255, 0.3);\r\n  margin: 0 10rpx;\r\n}\r\n\r\n.progress-line.active {\r\n  background: #fff;\r\n}\r\n\r\n/* ËÆ¢Âçï‰ø°ÊÅØÂç°Áâá */\r\n.order-info-card {\r\n  padding: 30rpx;\r\n}\r\n\r\n.info-section {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.info-section:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.section-title {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.address-item {\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.address-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.addr-label {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n  display: block;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.addr-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  display: block;\r\n}\r\n\r\n.contact-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.contact-label {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n}\r\n\r\n.contact-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n/* Êìç‰ΩúÊåâÈíÆ */\r\n.action-buttons {\r\n  display: flex;\r\n  gap: 20rpx;\r\n  padding: 0 30rpx 30rpx;\r\n}\r\n\r\n.action-btn {\r\n  flex: 1;\r\n  height: 88rpx;\r\n  border-radius: 44rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 28rpx;\r\n  border: none;\r\n}\r\n\r\n.action-btn::after {\r\n  border: none;\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 32rpx;\r\n  margin-right: 8rpx;\r\n}\r\n\r\n.call-btn {\r\n  background: #f5f5f5;\r\n  color: #333;\r\n}\r\n\r\n.finish-btn {\r\n  background: #07c160;\r\n  color: #fff;\r\n}\r\n\r\n/* Á©∫Áä∂ÊÄÅ */\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 120rpx 40rpx;\r\n}\r\n\r\n.empty-icon {\r\n  font-size: 150rpx;\r\n  margin-bottom: 30rpx;\r\n  opacity: 0.5;\r\n}\r\n\r\n.empty-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.empty-desc {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.go-hall-btn {\r\n  width: 300rpx;\r\n  height: 80rpx;\r\n  line-height: 80rpx;\r\n  border-radius: 40rpx;\r\n  background: #07c160;\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.go-hall-btn::after {\r\n  border: none;\r\n}\r\n\r\n/* ÁªüËÆ°Âç°Áâá */\r\n.stats-card {\r\n  margin: 0 20rpx;\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 30rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.stats-header {\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.stats-title {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.stats-content {\r\n  display: flex;\r\n}\r\n\r\n.stat-item {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 40rpx;\r\n  font-weight: bold;\r\n  color: #ff4d4f;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.stat-divider {\r\n  width: 2rpx;\r\n  background: #f5f5f5;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/Delivery Service Platform/uniapp/pages/running/running.vue'\nwx.createPage(MiniProgramPage)"],"names":["getRiderOrders","uni","getRiderDashboard","finishOrder"],"mappings":"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"}